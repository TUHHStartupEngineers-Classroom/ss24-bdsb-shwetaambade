---
title: "Tidyverse"
author: "Shweta Ambade"
editor: 
  markdown: 
    wrap: 72
---

# Read data from CSV file

data <- read.csv("bikes.csv") 
data <- read.csv("bikeshops.csv") 
data <- read.csv("orderlines.csv")

# Split state and city into separate columns

bike_orderlines_wrangled_tbl <- bike_orderlines_wrangled_tbl%\>%
separate(location, into = c("city", "state"), sep = ",", remove = FALSE)

# Group data by state and calculate total revenue

sales_by_loc_tbl <- bike_orderlines_wrangled_tbl %\>%
group_by(state)%\>% 
summarise(total_revenue = sum(revenue))

# Find state with the highest revenue
state_highest_revenue <- sales_by_loc_tbl %>%
  filter(total_revenue == max(total_revenue)) %>%
  pull(state)

# Create a bar plot of sales by state
ggplot(sales_by_loc_tbl, aes(x = state, y = total_revenue)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "State", y = "Total Revenue", title = "Sales by State") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  annotate("text", x = state_highest_revenue, y = max(sales_by_loc_tbl$total_revenue),
           label = paste("Highest Revenue:", max(sales_by_loc_tbl$total_revenue), "USD"),
           vjust = -0.5, hjust = 1, color = "red", size = 4)
# Group data by state and year, and calculate total revenue
sales_by_loc_year_tbl <- bike_orderlines_wrangled_tbl %>%
  group_by(state, year) %>%
  summarise(total_revenue = sum(revenue))

# Create facet_wrap plot for sales by location and year
ggplot(sales_by_loc_year_tbl, aes(x = year, y = total_revenue)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Year", y = "Total Revenue", title = "Sales by Location and Year") +
  facet_wrap(~state, ncol = 3)

